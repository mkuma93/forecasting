# Feature Configuration - Single Source of Truth
# Version: 1.3
# Date: 2025-12-13
# All models MUST use this exact feature specification

# Total aligned features: 40
# Breakdown: 1 trend + 6 cyclical + 3 lags + 15 holiday distances + 15 holiday binaries

trend_features:
  - name: time_index
    description: "Numeric time index (days since Unix epoch 1970-01-01)"
    source_column: "ds"  # Will be converted to days since Unix epoch 1970-01-01
    transformation: "days_since_epoch"
    index: 0

cyclical_features:
  - name: dow_sin
    description: "Sine encoding of day of week (0-6)"
    formula: "sin(2π * day_of_week / 7)"
    index: 1
    
  - name: dow_cos
    description: "Cosine encoding of day of week (0-6)"
    formula: "cos(2π * day_of_week / 7)"
    index: 2
    
  - name: month_sin
    description: "Sine encoding of month (1-12)"
    formula: "sin(2π * month / 12)"
    index: 3
    
  - name: month_cos
    description: "Cosine encoding of month (1-12)"
    formula: "cos(2π * month / 12)"
    index: 4
    
  - name: year_sin
    description: "Sine encoding of day of year (1-365/366)"
    formula: "sin(2π * day_of_year / 365.25)"
    index: 5
    
  - name: year_cos
    description: "Cosine encoding of day of year (1-365/366)"
    formula: "cos(2π * day_of_year / 365.25)"
    index: 6

lag_features:
  - name: lag_1
    description: "Demand 1 day ago"
    lag: 1
    index: 7
    
  - name: lag_2
    description: "Demand 2 days ago"
    lag: 2
    index: 8
    
  - name: lag_7
    description: "Demand 7 days ago (weekly pattern)"
    lag: 7
    index: 9

holiday_features:
  - name: days_from_NewYear
    description: "Days to/from New Year"
    index: 10
    
  - name: days_from_MLK
    description: "Days to/from Martin Luther King Jr. Day"
    index: 11
    
  - name: days_from_Presidents
    description: "Days to/from Presidents Day"
    index: 12
    
  - name: days_from_Valentine
    description: "Days to/from Valentine's Day"
    index: 13
    
  - name: days_from_Easter
    description: "Days to/from Easter"
    index: 14
    
  - name: days_from_Mothers
    description: "Days to/from Mother's Day"
    index: 15
    
  - name: days_from_Memorial
    description: "Days to/from Memorial Day"
    index: 16
    
  - name: days_from_Fathers
    description: "Days to/from Father's Day"
    index: 17
    
  - name: days_from_July4
    description: "Days to/from Independence Day"
    index: 18
    
  - name: days_from_Labor
    description: "Days to/from Labor Day"
    index: 19
    
  - name: days_from_Halloween
    description: "Days to/from Halloween"
    index: 20
    
  - name: days_from_Thanksgiving
    description: "Days to/from Thanksgiving"
    index: 21
    
  - name: days_from_BlackFriday
    description: "Days to/from Black Friday"
    index: 22
    
  - name: days_from_Christmas
    description: "Days to/from Christmas"
    index: 23
    
  - name: days_from_NewYearEve
    description: "Days to/from New Year's Eve"
    index: 24

binary_holiday_features:
  - name: is_NewYear
    description: "Binary indicator for New Year"
    index: 25
    
  - name: is_MLK
    description: "Binary indicator for Martin Luther King Jr. Day"
    index: 26
    
  - name: is_Presidents
    description: "Binary indicator for Presidents Day"
    index: 27
    
  - name: is_Valentine
    description: "Binary indicator for Valentine's Day"
    index: 28
    
  - name: is_Easter
    description: "Binary indicator for Easter"
    index: 29
    
  - name: is_Mothers
    description: "Binary indicator for Mother's Day"
    index: 30
    
  - name: is_Memorial
    description: "Binary indicator for Memorial Day"
    index: 31
    
  - name: is_Fathers
    description: "Binary indicator for Father's Day"
    index: 32
    
  - name: is_July4
    description: "Binary indicator for Independence Day"
    index: 33
    
  - name: is_Labor
    description: "Binary indicator for Labor Day"
    index: 34
    
  - name: is_Halloween
    description: "Binary indicator for Halloween"
    index: 35
    
  - name: is_Thanksgiving
    description: "Binary indicator for Thanksgiving"
    index: 36
    
  - name: is_BlackFriday
    description: "Binary indicator for Black Friday"
    index: 37
    
  - name: is_Christmas
    description: "Binary indicator for Christmas"
    index: 38
    
  - name: is_NewYearEve
    description: "Binary indicator for New Year's Eve"
    index: 39

# Model component indices
model_architecture:
  trend_component:
    description: "Long-term trend from time index"
    feature_indices: [0]
    feature_names: [time_index]
    
  seasonal_component:
    description: "Cyclical time encodings for seasonal patterns"
    feature_indices: [1, 2, 3, 4, 5, 6]
    feature_names: [dow_sin, dow_cos, month_sin, month_cos, year_sin, year_cos]
    
  regressor_component:
    description: "Autoregressive lag features"
    feature_indices: [7, 8, 9]
    feature_names: [lag_1, lag_2, lag_7]
    
  holiday_component:
    description: "Holiday proximity and binary indicator features"
    feature_indices: [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
    feature_names: [days_from_NewYear, days_from_MLK, days_from_Presidents, 
                    days_from_Valentine, days_from_Easter, days_from_Mothers,
                    days_from_Memorial, days_from_Fathers, days_from_July4,
                    days_from_Labor, days_from_Halloween, days_from_Thanksgiving,
                    days_from_BlackFriday, days_from_Christmas, days_from_NewYearEve,
                    is_NewYear, is_MLK, is_Presidents, is_Valentine, is_Easter,
                    is_Mothers, is_Memorial, is_Fathers, is_July4, is_Labor,
                    is_Halloween, is_Thanksgiving, is_BlackFriday, is_Christmas, is_NewYearEve]

# Feature creation order (CRITICAL - must match exactly)
feature_order:
  - time_index
  - dow_sin
  - dow_cos
  - month_sin
  - month_cos
  - year_sin
  - year_cos
  - lag_1
  - lag_2
  - lag_7
  - days_from_NewYear
  - days_from_MLK
  - days_from_Presidents
  - days_from_Valentine
  - days_from_Easter
  - days_from_Mothers
  - days_from_Memorial
  - days_from_Fathers
  - days_from_July4
  - days_from_Labor
  - days_from_Halloween
  - days_from_Thanksgiving
  - days_from_BlackFriday
  - days_from_Christmas
  - days_from_NewYearEve
  - is_NewYear
  - is_MLK
  - is_Presidents
  - is_Valentine
  - is_Easter
  - is_Mothers
  - is_Memorial
  - is_Fathers
  - is_July4
  - is_Labor
  - is_Halloween
  - is_Thanksgiving
  - is_BlackFriday
  - is_Christmas
  - is_NewYearEve

# Metadata
metadata:
  total_features: 40
  version: "1.3"
  last_updated: "2025-12-13"
  dataset_context: "Multi-country dataset (US, Australia, etc.) requires all 15 holidays"
  rationale: "Added binary holiday indicators (is_*) alongside distance features (days_from_*) to provide both sharp signals (binary) and build-up/decay patterns (distance). This gives model clearer holiday detection while preserving proximity information."
